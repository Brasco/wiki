<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Subresources Protections"><meta name=theme-color content="#FFFFFF"><meta property="og:title" content="Subresource Protections"><meta property="og:description" content="Subresources Protections"><meta property="og:type" content="article"><meta property="og:url" content="https://xsleaks.com/docs/defenses/design-protections/subresource-protections/"><meta property="article:published_time" content="2020-10-01T00:00:00+00:00"><meta property="article:modified_time" content="2020-10-15T10:03:56-07:00"><title>Subresource Protections | XS-Leaks Wiki</title><link rel=manifest href=/manifest.json><link rel=icon href=/favicon.png type=image/x-icon><link rel=stylesheet href=/book.min.092646ee0a13bc3d434088e3ef209623b91ad8714e3f5b61c7d3d1a096669ae7.css integrity="sha256-CSZG7goTvD1DQIjj7yCWI7ka2HFOP1thx9PRoJZmmuc="><script defer src=/en.search.min.0f6e5f18f23af702d7b7fc09107cc2d20f7dd133c303caade756ec665e07c206.js integrity="sha256-D25fGPI69wLXt/wJEHzC0g990TPDA8qt51bsZl4HwgY="></script><script defer src=/sw.min.74a8bb07f0bee86d6bb9a2750f073f14d93c7e4512f28860370cfd879e9719b4.js integrity="sha256-dKi7B/C+6G1ruaJ1Dwc/FNk8fkUS8ohgNwz9h56XGbQ="></script></head><body><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><nav><h2 class=book-brand><a href=/><span>XS-Leaks Wiki</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li class=book-section-flat><span>Attacks</span><ul><li><a href=/docs/attacks/xs-search/>XS-Search</a></li><li><a href=/docs/attacks/error-events/>Error Events</a></li><li><a href=/docs/attacks/frame-counting/>Frame Counting</a></li><li><a href=/docs/attacks/navigations/>Navigations</a></li><li><a href=/docs/attacks/cache-probing/>Cache Probing</a></li><li><a href=/docs/attacks/id-attribute/>ID Attribute</a></li><li><a href=/docs/attacks/postmessage-broadcasts/>postMessage Broadcasts</a></li><li><span>Browser Features</span><ul><li><a href=/docs/attacks/browser-features/corb/>CORB Leaks</a></li><li><a href=/docs/attacks/browser-features/corp/>CORP Leaks</a></li></ul></li><li><span>Timing Attacks</span><ul><li><a href=/docs/attacks/timing-attacks/clocks/>Clocks</a></li><li><a href=/docs/attacks/timing-attacks/network-timing/>Network Timing</a></li><li><a href=/docs/attacks/timing-attacks/execution-timing/>Execution Timing</a></li><li><a href=/docs/attacks/timing-attacks/hybrid-timing/>Hybrid Timing</a></li><li><a href=/docs/attacks/timing-attacks/connection-pool/>Connection Pool</a></li></ul></li><li><a href=/docs/attacks/experiments/ class=collapsed>Experiments</a></li><li><a href=/docs/attacks/historical/ class=collapsed>Historical</a></li></ul></li><li class=book-section-flat><a href=/docs/defenses/>Defense Mechanisms</a><ul><li><span>Application Design</span><ul><li><a href=/docs/defenses/design-protections/subresource-protections/ class=active>Subresource Protections</a></li></ul></li><li><span>Browser Default</span><ul><li><a href=/docs/defenses/browser-default/corb/>Cross-Origin Read Blocking</a></li><li><a href=/docs/defenses/browser-default/partitioned-cache/>Partitioned HTTP Cache</a></li></ul></li><li><span>Opt-In</span><ul><li><a href=/docs/defenses/opt-in/coop/>Cross-Origin-Opener-Policy</a></li><li><a href=/docs/defenses/opt-in/corp/>Cross-Origin-Resource-Policy</a></li><li><a href=/docs/defenses/opt-in/fetch-metadata/>Fetch Metadata</a></li><li><a href=/docs/defenses/opt-in/xfo/>Framing Protections</a></li><li><a href=/docs/defenses/opt-in/same-site-cookies/>Same-Site Cookies</a></li></ul></li></ul></li></ul></nav><script>(function(){var menu=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(event){localStorage.setItem("menu.scrollTop",menu.scrollTop);});menu.scrollTop=localStorage.getItem("menu.scrollTop");})();</script></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Subresource Protections</strong>
<label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#secure-tokens>Secure tokens</a></li><li><a href=#user-consent>User Consent</a></li><li><a href=#deployment>Deployment</a></li></ul></nav></aside></header><article class=markdown><h1>Subresource Protections</h1><h5>October 1, 2020</h5><div>Category
<a href=/category/defense/>Defense</a></div><p><p>The fundamental idea of designing protections for subresources is that subresources cannot be targeted by XS-Leaks if the attacker cannot cause them to return any user data.</p><h2 id=secure-tokens>Secure tokens
<a class=anchor href=#secure-tokens>#</a></h2><p>One way of achieving this is similar to how endpoints can be protected from <a href=https://owasp.org/www-community/attacks/csrf>CSRF attacks</a>. While <a href=https://cheatsheetseries.owasp.org/cheatsheets/Cross-Site_Request_Forgery_Prevention_Cheat_Sheet.html>CSRF protections</a> tend to focus on state changing requests, XS-Leak protections are meant to defend <code>GET</code> requests.</p><p>To apply this protection, each request for a subresource needs to include some unique value that attackers cannot obtain. One way would be to place an unguessable random ID in the URL. For example, instead of <code>victim.com/chat_room?name=Secret-Chat</code> one could use <code>victim.com/chat_room?name=Secret-Chat&xsrf=&lt;random ID></code>. While this would mitigate cache based attacks, this might not protect against forging the requests. Another potential strategy is to include signed attestations in the URLs, which would protect both the cache and the request forgery. But this may not provide sufficient protection in case where the attacker is able to obtain a secure token that is valid for retrieving the user&rsquo;s data.</p><p>This style of protection can be applied to:</p><ul><li>Authenticated subresources such as API endpoints or regular authenticated URLs. While secure tokens can be used in this case, security mitigations like <a href=https://xsleaks.com/docs/defenses/opt-in/same-site-cookies/>Same-Site Cookies</a> can be easier to deploy and more effective.</li><li>Unauthenticated subresources such as images can use this protection to prevent some types of <a href=https://xsleaks.com/docs/attacks/cache-probing/>Cache Probing Attacks</a>. This protection can be highly effective for unauthenticated subresources, but it would negatively impact the cache efficiency and might be otherwise hard to deploy.</li></ul><h2 id=user-consent>User Consent
<a class=anchor href=#user-consent>#</a></h2><p>By prompting for user interaction prior to returning sensitive results, one can ensure that sensitive results cannot be included in places they should not end up (e.g.<code>script</code> or <code>img</code> tags). For example, Facebook requires user confirmation before viewing search results or private messages. Since attackers cannot simulate this user interaction, they will be unable to leak the contents of the search results.</p><p>Another common application of this is when applications are redirecting users to another website. It is common to require user confirmation before the redirect. This prevents attackers from <a href=https://xsleaks.com/docs/attacks/navigations/>detecting some types of navigations</a>.</p><h2 id=deployment>Deployment
<a class=anchor href=#deployment>#</a></h2><p>While this protection can work in some scenarios, it has some disadvantages:</p><ul><li>Hard to deploy as it requires substantial changes in the codebase.</li><li>It might break the desired behavior for the feature.</li><li>In the case of random tokens, it will break bookmarks and other permanent references.</li><li>Consent pages might add friction to using the application.</li></ul><blockquote class="book-hint warning">It can be very effective to deploy this on any specific resources that are known to be especially senstive to XS-Leaks. But, due to the challenges of deploying this protection universally, applications are encouraged to deploy <a href=https://xsleaks.com/docs/defenses/>opt-in web platform security features</a> as the default approach.</blockquote></p></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/xsleaks/wiki/commit/62318caeacfbbadd942c5b569a67be481b7bc558 title="Last modified by David Dworken | October 15, 2020" target=_blank rel=noopener><img src=/svg/calendar.svg class=book-icon alt=Calendar>
<span>Last Modified: October 15, 2020</span></a></div><div><a class="flex align-center" href=https://github.com/xsleaks/wiki/edit/master/content//docs/defenses/design-protections/subresource-protections.md target=_blank rel=noopener><img src=/svg/edit.svg class=book-icon alt=Edit>
<span>Edit this article</span></a></div></div></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><nav id=TableOfContents><ul><li><a href=#secure-tokens>Secure tokens</a></li><li><a href=#user-consent>User Consent</a></li><li><a href=#deployment>Deployment</a></li></ul></nav></aside></main></body></html>