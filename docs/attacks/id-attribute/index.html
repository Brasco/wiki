<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Explanation #  The id attribute is widely used to identify some HTML elements. Unfortunately, these ids can be leaked by leveraging the focus event and the URL fragment. There are two alternatives to complete this attack:
 By using an iframe an attacker can load the target website once and brute-force the URL hash until the focus event fires. The onblur event can be used to detect when the target has focus 1."><meta name=theme-color content="#FFFFFF"><meta property="og:title" content="ID Attribute"><meta property="og:description" content="Explanation #  The id attribute is widely used to identify some HTML elements. Unfortunately, these ids can be leaked by leveraging the focus event and the URL fragment. There are two alternatives to complete this attack:
 By using an iframe an attacker can load the target website once and brute-force the URL hash until the focus event fires. The onblur event can be used to detect when the target has focus 1."><meta property="og:type" content="article"><meta property="og:url" content="https://xsleaks.com/docs/attacks/id-attribute/"><meta property="article:published_time" content="2020-07-21T00:00:00+00:00"><meta property="article:modified_time" content="2020-08-27T11:37:52+01:00"><title>ID Attribute | XS-Leaks Wiki</title><link rel=manifest href=/manifest.json><link rel=icon href=/favicon.png type=image/x-icon><link rel=stylesheet href=/book.min.3fdda1dce1e2459a1b1fc70c3e00001cd6e4d2f1f32f38ddef6e12ca41e9cef6.css integrity="sha256-P92h3OHiRZobH8cMPgAAHNbk0vHzLzjd724SykHpzvY="><script defer src=/en.search.min.55bbe51b7c566d76276792047f4ea0e56d93dbbc0aefdca33c3791dc096ab941.js integrity="sha256-VbvlG3xWbXYnZ5IEf06g5W2T27wK79yjPDeR3AlquUE="></script><script defer src=/sw.min.74a8bb07f0bee86d6bb9a2750f073f14d93c7e4512f28860370cfd879e9719b4.js integrity="sha256-dKi7B/C+6G1ruaJ1Dwc/FNk8fkUS8ohgNwz9h56XGbQ="></script></head><body><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><nav><h2 class=book-brand><a href=/><span>XS-Leaks Wiki</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li class=book-section-flat><a href=/docs/attacks/>Attacks</a><ul><li><a href=/docs/attacks/experiments/>Experiments</a><ul><li><a href=/docs/attacks/experiments/scroll-to-text-fragment/>Scroll to Text Fragment</a></li></ul></li><li><a href=/docs/attacks/historical/ class=collapsed>Historical</a></li><li><a href=/docs/attacks/timing-attacks/>Timing Attacks</a><ul><li><a href=/docs/attacks/timing-attacks/clocks/>Clocks</a></li><li><a href=/docs/attacks/timing-attacks/connection-pool/>Connection Pool</a></li><li><a href=/docs/attacks/timing-attacks/execution-timing/>Execution Timing</a></li><li><a href=/docs/attacks/timing-attacks/hybrid-timing/>Hybrid Timing</a></li><li><a href=/docs/attacks/timing-attacks/network-timing/>Network Timing</a></li></ul></li><li><a href=/docs/attacks/corb/>CORB Leaks</a></li><li><a href=/docs/attacks/corp/>CORP Leaks</a></li><li><a href=/docs/attacks/error-events/>Error Events</a></li><li><a href=/docs/attacks/frame-counting/>Frame Counting</a></li><li><a href=/docs/attacks/id-attribute/ class=active>ID Attribute</a></li><li><a href=/docs/attacks/navigations/>Navigations</a></li><li><a href=/docs/attacks/postmessage-broadcasts/>postMessage Broadcasts</a></li><li><a href=/docs/attacks/xs-search/>XS-Search</a></li><li><a href=/docs/attacks/cache-probing/>Cache Probing</a></li></ul></li><li class=book-section-flat><a href=/docs/defenses/>Defense Mechanisms</a><ul><li><span>Application Design</span><ul><li><a href=/docs/defenses/design-protections/subresource-protections/>Subresource Protections</a></li></ul></li><li><span>Browser Default</span><ul><li><a href=/docs/defenses/browser-intrinsic/corb/>Cross-Origin Read Blocking</a></li><li><a href=/docs/defenses/browser-intrinsic/partitioned-cache/>Partitioned HTTP Cache</a></li></ul></li><li><span>Opt-In</span><ul><li><a href=/docs/defenses/opt-in/coop/>Cross-Origin-Opener-Policy</a></li><li><a href=/docs/defenses/opt-in/corp/>Cross-Origin-Resource-Policy</a></li><li><a href=/docs/defenses/opt-in/fetch-metadata/>Fetch Metadata</a></li><li><a href=/docs/defenses/opt-in/xfo/>Framing Protections</a></li><li><a href=/docs/defenses/opt-in/same-site-cookies/>Same-Site Cookies</a></li></ul></li></ul></li></ul></nav><script>(function(){var menu=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(event){localStorage.setItem("menu.scrollTop",menu.scrollTop);});menu.scrollTop=localStorage.getItem("menu.scrollTop");})();</script></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label>
<strong>ID Attribute</strong>
<label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#explanation>Explanation</a><ul><li><a href=#why-is-this-a-problem>Why is this a problem?</a></li></ul></li><li><a href=#defense>Defense</a></li><li><a href=#references>References</a></li></ul></nav></aside></header><article class=markdown><h1>ID Attribute</h1><h5>July 21, 2020</h5><div>Attacks
<a href=/attacks/ids/>ids</a></div><div>Category
<a href=/category/attacks/>attacks</a></div><div>Defenses
<a href=/defenses/same-site-cookies/>same-site cookies</a></div><p><h2 id=explanation>Explanation
<a class=anchor href=#explanation>#</a></h2><p>The <code>id</code> attribute is widely used to identify some <code>HTML</code> elements. Unfortunately, these <code>ids</code> can be leaked by leveraging the <code>focus</code> event and the <code>URL</code> fragment. There are two alternatives to complete this attack:</p><ul><li>By using an <code>iframe</code> an attacker can load the target website once and brute-force the <code>URL</code> hash until the <code>focus</code> event fires. The <code>onblur</code> event can be used to detect when the target has focus <sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>.</li><li>If the website sets <a href=https://xsleaks.com/docs/defenses/opt-in/xfo/>framing protections</a>, the previous technique can be applied using the <code>portal</code> element <sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>.</li></ul><h3 id=why-is-this-a-problem>Why is this a problem?
<a class=anchor href=#why-is-this-a-problem>#</a></h3><p>Sometimes web applications set <code>id</code> attributes in <code>focusable</code> elements that may lead to user information disclosure. These <code>ids</code> can either be direct information related to the user (i.e a secret) or information associated with a user state (i.e account status).</p><h4 id=case-scenarios>Case Scenarios
<a class=anchor href=#case-scenarios>#</a></h4><ul><li>A bank allows its clients to generate 4 digit One-Time PINs (OTP) in the browser application to authenticate sessions on the mobile. The bank did a couple of mistakes and put the 4 digit OTP as the <code>id</code> of a <code>button</code>, used to show the PIN to the client. By targeting clients using the properties of this XS-Leak, it might be possible to compromise their accounts.</li><li>A web application uses a specific set of predefined <code>ids</code> and <code>HTML</code> elements when an account has a premium status or the user is of a certain gender. The attacker can detect whether a specific <code>id</code> is present in the victim&rsquo;s page and leak the account information.</li></ul><h2 id=defense>Defense
<a class=anchor href=#defense>#</a></h2><table><thead><tr><th style=text-align:center>Attack Alternative</th><th style=text-align:center><a href=https://xsleaks.com/docs/defenses/opt-in/same-site-cookies/>Same-Site Cookies</a></th><th style=text-align:center><a href=https://xsleaks.com/docs/defenses/opt-in/fetch-metadata/>Fetch Metadata</a></th><th style=text-align:center><a href=https://xsleaks.com/docs/defenses/opt-in/coop/>Cross-Origin-Opener-Policy</a></th><th style=text-align:center><a href=https://xsleaks.com/docs/defenses/opt-in/xfo/>Framing Protections</a></th></tr></thead><tbody><tr><td style=text-align:center>iframe</td><td style=text-align:center>✔️</td><td style=text-align:center>✔️</td><td style=text-align:center>❌</td><td style=text-align:center>✔️</td></tr><tr><td style=text-align:center>portal</td><td style=text-align:center>✔️</td><td style=text-align:center>✔️</td><td style=text-align:center>❌</td><td style=text-align:center>❌</td></tr></tbody></table><blockquote class="book-hint warning">The <a href=https://web.dev/hands-on-portals/><code>portal</code></a> element is only available on Chromium-based browsers under a preference flag. The corresponding specification is still under active discussion.</blockquote><h2 id=references>References
<a class=anchor href=#references>#</a></h2><section class=footnotes role=doc-endnotes><hr><ol><li id=fn:1 role=doc-endnote><p>Leaking IDs using focus, <a href=https://portswigger.net/research/xs-leak-leaking-ids-using-focus>link</a> <a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2 role=doc-endnote><p>Detecting IDs using Portal, <a href=https://portswigger.net/research/xs-leak-detecting-ids-using-portal>link</a> <a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></section></p></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/xsleaks/wiki/commit/bcfb95de5c7ececaa7094296584e1dbe156b946b title="Last modified by Manuel Sousa | August 27, 2020" target=_blank rel=noopener><img src=/svg/calendar.svg class=book-icon alt=Calendar>
<span>Last Modified: August 27, 2020</span></a></div><div><a class="flex align-center" href=https://github.com/xsleaks/wiki/edit/master/content//docs/attacks/id-attribute.md target=_blank rel=noopener><img src=/svg/edit.svg class=book-icon alt=Edit>
<span>Edit this article</span></a></div></div></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><nav id=TableOfContents><ul><li><a href=#explanation>Explanation</a><ul><li><a href=#why-is-this-a-problem>Why is this a problem?</a></li></ul></li><li><a href=#defense>Defense</a></li><li><a href=#references>References</a></li></ul></nav></aside></main></body></html>