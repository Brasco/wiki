<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Detecting if a cross-site page triggered a navigation (or didn&rsquo;t) can be useful to an attacker. For example, a website may trigger a navigation in a certain endpoint depending on the status of the user.
To detect ifany kind of navigation occurred, an attacker can:
 Use an iframe and count the number of times the onload event is triggered. Check the value of history.length, accessible through any window reference. This gives the number of entries in the history of a victim either changed by history."><meta name=theme-color content="#FFFFFF"><meta property="og:title" content="Navigations"><meta property="og:description" content="Detecting if a cross-site page triggered a navigation (or didn&rsquo;t) can be useful to an attacker. For example, a website may trigger a navigation in a certain endpoint depending on the status of the user.
To detect ifany kind of navigation occurred, an attacker can:
 Use an iframe and count the number of times the onload event is triggered. Check the value of history.length, accessible through any window reference. This gives the number of entries in the history of a victim either changed by history."><meta property="og:type" content="article"><meta property="og:url" content="https://xsleaks.com/docs/attacks/navigations/"><meta property="article:published_time" content="2020-10-01T00:00:00+00:00"><meta property="article:modified_time" content="2020-10-14T14:05:24-07:00"><title>Navigations | XS-Leaks Wiki</title><link rel=manifest href=/manifest.json><link rel=icon href=/favicon.png type=image/x-icon><link rel=stylesheet href=/book.min.092646ee0a13bc3d434088e3ef209623b91ad8714e3f5b61c7d3d1a096669ae7.css integrity="sha256-CSZG7goTvD1DQIjj7yCWI7ka2HFOP1thx9PRoJZmmuc="><script defer src=/en.search.min.fef1bf2a83f391469eba1d6468a622f84165ad1bda224eccc14433cca9d14c47.js integrity="sha256-/vG/KoPzkUaeuh1kaKYi+EFlrRvaIk7MwUQzzKnRTEc="></script><script defer src=/sw.min.74a8bb07f0bee86d6bb9a2750f073f14d93c7e4512f28860370cfd879e9719b4.js integrity="sha256-dKi7B/C+6G1ruaJ1Dwc/FNk8fkUS8ohgNwz9h56XGbQ="></script></head><body><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><nav><h2 class=book-brand><a href=/><span>XS-Leaks Wiki</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li class=book-section-flat><span>Attacks</span><ul><li><a href=/docs/attacks/xs-search/>XS-Search</a></li><li><a href=/docs/attacks/error-events/>Error Events</a></li><li><a href=/docs/attacks/frame-counting/>Frame Counting</a></li><li><a href=/docs/attacks/navigations/ class=active>Navigations</a></li><li><a href=/docs/attacks/cache-probing/>Cache Probing</a></li><li><a href=/docs/attacks/id-attribute/>ID Attribute</a></li><li><a href=/docs/attacks/postmessage-broadcasts/>postMessage Broadcasts</a></li><li><span>Browser Features</span><ul><li><a href=/docs/attacks/browser-features/corb/>CORB Leaks</a></li><li><a href=/docs/attacks/browser-features/corp/>CORP Leaks</a></li></ul></li><li><span>Timing Attacks</span><ul><li><a href=/docs/attacks/timing-attacks/clocks/>Clocks</a></li><li><a href=/docs/attacks/timing-attacks/network-timing/>Network Timing</a></li><li><a href=/docs/attacks/timing-attacks/execution-timing/>Execution Timing</a></li><li><a href=/docs/attacks/timing-attacks/hybrid-timing/>Hybrid Timing</a></li><li><a href=/docs/attacks/timing-attacks/connection-pool/>Connection Pool</a></li></ul></li><li><a href=/docs/attacks/experiments/ class=collapsed>Experiments</a></li><li><a href=/docs/attacks/historical/ class=collapsed>Historical</a></li></ul></li><li class=book-section-flat><a href=/docs/defenses/>Defense Mechanisms</a><ul><li><a href=/docs/defenses/design-protections/>Application Design</a><ul><li><a href=/docs/defenses/design-protections/cache-protections/>Cache Protections</a></li><li><a href=/docs/defenses/design-protections/subresource-protections/>Subresource Protections</a></li></ul></li><li><a href=/docs/defenses/opt-in/>Opt-In Mechanisms</a><ul><li><a href=/docs/defenses/opt-in/coop/>Cross-Origin-Opener-Policy</a></li><li><a href=/docs/defenses/opt-in/corp/>Cross-Origin-Resource-Policy</a></li><li><a href=/docs/defenses/opt-in/fetch-metadata/>Fetch Metadata</a></li><li><a href=/docs/defenses/opt-in/xfo/>Framing Protections</a></li><li><a href=/docs/defenses/opt-in/same-site-cookies/>Same-Site Cookies</a></li></ul></li><li><a href=/docs/defenses/secure-defaults/>Secure Defaults</a><ul><li><a href=/docs/defenses/secure-defaults/corb/>Cross-Origin Read Blocking</a></li><li><a href=/docs/defenses/secure-defaults/partitioned-cache/>Partitioned HTTP Cache</a></li></ul></li></ul></li></ul></nav><script>(function(){var menu=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(event){localStorage.setItem("menu.scrollTop",menu.scrollTop);});menu.scrollTop=localStorage.getItem("menu.scrollTop");})();</script></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Navigations</strong>
<label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents><ul><li><a href=#download-trigger>Download Trigger</a><ul><li><a href=#download-bar>Download bar</a></li><li><a href=#download-navigation>Download Navigation</a></li></ul></li><li><a href=#server-side-redirects>Server-Side Redirects</a><ul><li><a href=#inflation>Inflation</a></li></ul></li><li><a href=#cross-origin-redirects>Cross-Origin Redirects</a><ul><li><a href=#csp-violations>CSP Violations</a></li></ul></li><li><a href=#case-scenarios>Case Scenarios</a></li><li><a href=#defense>Defense</a></li><li><a href=#real-world-examples>Real-World Examples</a></li><li><a href=#references>References</a></li></ul></nav></aside></header><article class=markdown><h1>Navigations</h1><h5>October 1, 2020</h5><div>Abuse
<a href=/abuse/downloads/>Downloads</a>,
<a href=/abuse/history/>History</a>,
<a href=/abuse/csp-violations/>CSP Violations</a>,
<a href=/abuse/redirects/>Redirects</a>,
<a href=/abuse/window.open/>window.open</a>,
<a href=/abuse/iframes/>iframes</a></div><div>Category
<a href=/category/attack/>Attack</a></div><div>Defenses
<a href=/defenses/fetch-metadata/>Fetch Metadata</a>,
<a href=/defenses/samesite-cookies/>SameSite Cookies</a>,
<a href=/defenses/coop/>COOP</a>,
<a href=/defenses/framing-protections/>Framing Protections</a></div><p><p>Detecting if a cross-site page triggered a navigation (or didn&rsquo;t) can be useful to an attacker. For example, a website may trigger a navigation in a certain endpoint <a href=#case-scenarios>depending on the status of the user</a>.</p><p>To detect ifany kind of navigation occurred, an attacker can:</p><ul><li>Use an <code>iframe</code> and count the number of times the <code>onload</code> event is triggered.</li><li>Check the value of <code>history.length</code>, accessible through any window reference. This gives the number of entries in the history of a victim either changed by <code>history.pushState</code> or regular navigations. To get the value of <code>history.length</code> an attacker changes the location of the window reference with the target website, changes back to same-origin, and finally reads the value.</li></ul><h2 id=download-trigger>Download Trigger
<a class=anchor href=#download-trigger>#</a></h2><p>When endpoints set the <a href=https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Disposition><code>Content-Disposition: attachment</code></a> header, it instructs the browser to download the response as an attachment instead of navigating to it. Detecting if this behavior occurred might allow attackers to leak private information if outcome depends on the state of the victim&rsquo;s account.</p><h3 id=download-bar>Download bar
<a class=anchor href=#download-bar>#</a></h3><p>In Chromium-based browsers when a file is downloaded, a preview of the download process appears in a bar at the bottom, integrated into the browser window. By monitoring the window height attackers could detect whether the &ldquo;download bar&rdquo; opened.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript>
<span style=color:#75715e>// Any Window reference (can also be done using an iframe in some cases)
</span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>tab</span> <span style=color:#f92672>=</span> window.<span style=color:#a6e22e>opener</span>;

<span style=color:#75715e>// The current window height
</span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>screenHeight</span> <span style=color:#f92672>=</span> window.<span style=color:#a6e22e>innerHeight</span>;

<span style=color:#75715e>// The size of the chrome download bar on, for example, mac os x
</span><span style=color:#75715e></span><span style=color:#66d9ef>const</span> <span style=color:#a6e22e>downloadsBarSize</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>49</span>;

<span style=color:#a6e22e>tab</span>.<span style=color:#a6e22e>location</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;https://target.page&#39;</span>;

<span style=color:#a6e22e>setTimeout</span>(() =&gt; {
    <span style=color:#66d9ef>let</span> <span style=color:#a6e22e>margin</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>screenHeight</span> <span style=color:#f92672>-</span> window.<span style=color:#a6e22e>innerHeight</span>;
    <span style=color:#66d9ef>if</span> (<span style=color:#a6e22e>margin</span> <span style=color:#f92672>===</span> <span style=color:#a6e22e>downloadsBarSize</span>) {
       <span style=color:#66d9ef>return</span> <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#39;downloads bar detected&#39;</span>);
    }
}, <span style=color:#ae81ff>5</span> <span style=color:#f92672>*</span> <span style=color:#ae81ff>1000</span>);
</code></pre></div><blockquote class="book-hint good">This attack is only possible in Chromium-based browsers.</blockquote><h3 id=download-navigation>Download Navigation
<a class=anchor href=#download-navigation>#</a></h3><p>Another way to test for the <a href=https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Content-Disposition><code>Content-Disposition: attachment</code></a> header is to check if a navigation occurred. If a page load causes a download, it will not trigger a navigation.</p><ol><li>Open an attacker origin with <code>window.open</code> and save the window reference.</li><li>Navigate the saved reference to the endpoint that might download.</li><li>After a timeout, check if the window is still same-origin</li></ol><p>The snippet presented in the <a href=https://xsleaks.com/docs/attacks/timing-attacks/network-timing/#cross-window-timing-attacks>Cross-Window Timing</a> XS-Leak can be slightly adapted to detect this behavior.</p><h4 id=download-navigation-without-timeout>Download Navigation (without timeout)
<a class=anchor href=#download-navigation-without-timeout>#</a></h4><p>The following snippet can obtain a more precise measurement without relying on timeouts and imprecise timings.</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">10
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">11
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">12
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">13
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">14
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">15
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">16
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=color:#a6e22e>onmessage</span> <span style=color:#f92672>=</span> <span style=color:#a6e22e>e</span> =&gt; <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#a6e22e>e</span>.<span style=color:#a6e22e>data</span>);
<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>outer</span> <span style=color:#f92672>=</span> document.<span style=color:#a6e22e>createElement</span>(<span style=color:#e6db74>&#39;iframe&#39;</span>);
<span style=color:#66d9ef>var</span> <span style=color:#a6e22e>url</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>&#39;https://target.page&#39;</span>;
<span style=color:#a6e22e>outer</span>.<span style=color:#a6e22e>src</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>`data:text/html,</span><span style=color:#960050;background-color:#1e0010>\</span><span style=color:#e6db74>
</span><span style=color:#e6db74>            &lt;iframe id=&#39;inner&#39; src=&#34;</span><span style=color:#e6db74>${</span><span style=color:#a6e22e>url</span><span style=color:#e6db74>}</span><span style=color:#e6db74>&#34; &gt;&lt;/iframe&gt;
</span><span style=color:#e6db74>            &lt;!-- onload is part of outer iframe --&gt;
</span><span style=color:#e6db74>            &lt;script&gt;onload=()=&gt;{
</span><span style=color:#e6db74>                try {
</span><span style=color:#e6db74>                    inner.contentWindow.location.href;
</span><span style=color:#e6db74>                    top.postMessage(&#39;download attempt&#39;,&#39;*&#39;);
</span><span style=color:#e6db74>                } catch(e) {
</span><span style=color:#e6db74>                    top.postMessage(&#39;no download&#39;,&#39;*&#39;);
</span><span style=color:#e6db74>                }
</span><span style=color:#e6db74>            }&lt;/script&gt;`</span>;
<span style=color:#a6e22e>outer</span>.<span style=color:#a6e22e>onload</span> <span style=color:#f92672>=</span> ()=&gt;{<span style=color:#a6e22e>outer</span>.<span style=color:#a6e22e>remove</span>();}
document.<span style=color:#a6e22e>body</span>.<span style=color:#a6e22e>appendChild</span>(<span style=color:#a6e22e>outer</span>);
</code></pre></td></tr></table></div></div><p>The attack works as follows:</p><ol><li>Include an <code>iframe</code> (inner) inside an <code>iframe</code> (outer). The inner <code>iframe</code> embeds the target website.</li><li>If the target website triggers a download the inner <code>iframe</code> origin will remain <code>about:blank</code> (downloads don’t navigate).</li><li>Even though the download attempt doesn&rsquo;t trigger an <code>onload</code> event on the inner <code>iframe</code>, the window of the <code>outer</code> <code>iframe</code> (line 7) still waits for the resource to start the download and fires the <code>onload</code> event.</li><li>If a navigation has occurred the inner <code>iframe</code> will change its origin.</li><li>When the outer <code>iframe</code> <code>onload</code> fires the outer <code>iframe</code> verifies if <code>i.contentWindow.location.href</code> (line 9) is accessible, only possible if both <code>iframes</code> share the same origin (Same-Origin Policy is enforced). If both <code>iframes</code> are in different origins, a <code>DOMException</code> will be thrown, meaning a navigation occurred.</li></ol><h2 id=server-side-redirects>Server-Side Redirects
<a class=anchor href=#server-side-redirects>#</a></h2><h3 id=inflation>Inflation
<a class=anchor href=#inflation>#</a></h3><p>A server-side redirect can be detected from a cross-origin page if the destination URL increases in size and contains an attacker controlled input (either in the form of a query string parameter or a path). The following technique relies on the fact that it is possible to induce an error in most web-servers by generating big requests parameters/paths. Since the redirect increases the size of the URL, it can be detected by sending exactly one character less than the server maximum capacity. That way if the size increases the server will respond with an error that can be detected from a cross-origin page (eg via Error Events).</p><h2 id=cross-origin-redirects>Cross-Origin Redirects
<a class=anchor href=#cross-origin-redirects>#</a></h2><h3 id=csp-violations>CSP Violations
<a class=anchor href=#csp-violations>#</a></h3><p><a href=https://developer.mozilla.org/en-US/docs/Web/HTTP/CSP>Content-Security-Policy</a> (CSP) is an in-depth defense mechanism against XSS and data injection attacks. When a CSP is violated, a <code>SecurityPolicyViolationEvent</code> is thrown. An attacker can set up a CSP which will trigger a <code>Violation</code> event every time a <code>fetch</code> follows an URL not set in the CSP directive. This will allow an attacker to detect if a redirect to another origin occurred <sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup> <sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>.</p><p>The example below will trigger a <code>SecurityPolicyViolationEvent</code> if the website set in fetch API (line 6) redirects to a website different then <code>target.page</code>.</p><div class=highlight><div style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0;width:auto;overflow:auto;display:block><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">1
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">2
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">3
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">4
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">5
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">6
</span><span style="margin-right:.4em;padding:0 .4em;color:#7f7f7f">7
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-html data-lang=html>&lt;<span style=color:#f92672>meta</span> <span style=color:#a6e22e>http-equiv</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;Content-Security-Policy&#34;</span> <span style=color:#a6e22e>content</span><span style=color:#f92672>=</span><span style=color:#e6db74>&#34;default-src &#39;unsafe-inline&#39; target.page&#34;</span>&gt;
&lt;<span style=color:#f92672>script</span>&gt;
document.<span style=color:#a6e22e>addEventListener</span>(<span style=color:#e6db74>&#39;securitypolicyviolation&#39;</span>, <span style=color:#a6e22e>e</span> =&gt; {
  <span style=color:#a6e22e>console</span>.<span style=color:#a6e22e>log</span>(<span style=color:#e6db74>&#34;redirected&#34;</span>);
});
<span style=color:#a6e22e>fetch</span>(<span style=color:#e6db74>&#39;https://target.page/might_redirect&#39;</span>, {<span style=color:#a6e22e>mode</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;no-cors&#39;</span>,<span style=color:#a6e22e>credentials</span><span style=color:#f92672>:</span> <span style=color:#e6db74>&#39;include&#39;</span>});
&lt;/<span style=color:#f92672>script</span>&gt;</code></pre></td></tr></table></div></div><h2 id=case-scenarios>Case Scenarios
<a class=anchor href=#case-scenarios>#</a></h2><ul><li>An online bank decides to redirect wealthy users to unmissable stock opportunities by triggering a navigation to a reserved space on the website when users are consulting the account balance. If this is only done to a specific group of users, it becomes possible for an attacker to leak the &ldquo;client status&rdquo; of the user.</li></ul><h2 id=defense>Defense
<a class=anchor href=#defense>#</a></h2><table><thead><tr><th style=text-align:center>Attack Alternative</th><th style=text-align:center><a href=https://xsleaks.com/docs/defenses/opt-in/same-site-cookies/>Same-Site Cookies</a></th><th style=text-align:center><a href=https://xsleaks.com/docs/defenses/opt-in/fetch-metadata/>Fetch Metadata</a></th><th style=text-align:center><a href=https://xsleaks.com/docs/defenses/opt-in/coop/>COOP</a></th><th style=text-align:center><a href=https://xsleaks.com/docs/defenses/opt-in/xfo/>Framing Protections</a></th></tr></thead><tbody><tr><td style=text-align:center>iframe</td><td style=text-align:center>✔️</td><td style=text-align:center>✔️</td><td style=text-align:center>❌</td><td style=text-align:center>✔️</td></tr><tr><td style=text-align:center><code>History.length</code> (iframe)</td><td style=text-align:center>✔️</td><td style=text-align:center>✔️</td><td style=text-align:center>❌</td><td style=text-align:center>✔️</td></tr><tr><td style=text-align:center><code>History.length</code> (window.open)</td><td style=text-align:center>✔️ <a href=https://xsleaks.com/docs/defenses/opt-in/same-site-cookies/#lax-vs-strict>(if Strict)</a></td><td style=text-align:center>✔️</td><td style=text-align:center>✔️</td><td style=text-align:center>❌</td></tr><tr><td style=text-align:center>Download bar</td><td style=text-align:center>✔️</td><td style=text-align:center>✔️</td><td style=text-align:center>✔️</td><td style=text-align:center>✔️</td></tr><tr><td style=text-align:center>Download Navigation (w/ timeout)</td><td style=text-align:center>✔️ <a href=https://xsleaks.com/docs/defenses/opt-in/same-site-cookies/#lax-vs-strict>(if Strict)</a></td><td style=text-align:center>✔️</td><td style=text-align:center>❓</td><td style=text-align:center>✔️</td></tr><tr><td style=text-align:center>Download Navigation (no timeout)</td><td style=text-align:center>✔️</td><td style=text-align:center>✔️</td><td style=text-align:center>✔️</td><td style=text-align:center>✔️</td></tr><tr><td style=text-align:center>CSP Violations</td><td style=text-align:center>✔️</td><td style=text-align:center>✔️</td><td style=text-align:center>❌</td><td style=text-align:center>❌</td></tr></tbody></table><h2 id=real-world-examples>Real-World Examples
<a class=anchor href=#real-world-examples>#</a></h2><ul><li>A vulnerability reported to Twitter used this technique to leak the contents of private tweets using <a href=https://xsleaks.com/docs/attacks/xs-search/>XS-Search</a>. This attack was possible because the page would only trigger a navigation depending on whether there were results to the user query <sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup>.</li></ul><h2 id=references>References
<a class=anchor href=#references>#</a></h2><section class=footnotes role=doc-endnotes><hr><ol><li id=fn:1 role=doc-endnote><p>Disclose domain of redirect destination taking advantage of CSP, <a href="https://bugs.chromium.org/p/chromium/issues/detail?id=313737">link</a> <a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2 role=doc-endnote><p>Using Content-Security-Policy for Evil, <a href=http://homakov.blogspot.com/2014/01/using-content-security-policy-for-evil.html>link</a> <a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3 role=doc-endnote><p>Protected tweets exposure through the url, <a href=https://hackerone.com/reports/491473>link</a> <a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></section></p></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/xsleaks/wiki/commit/9b963202107fa3bd5834d14f2e61a085192ae77f title="Last modified by David Dworken | October 14, 2020" target=_blank rel=noopener><img src=/svg/calendar.svg class=book-icon alt=Calendar>
<span>Last Modified: October 14, 2020</span></a></div><div><a class="flex align-center" href=https://github.com/xsleaks/wiki/edit/master/content//docs/attacks/navigations.md target=_blank rel=noopener><img src=/svg/edit.svg class=book-icon alt=Edit>
<span>Edit this article</span></a></div></div></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><nav id=TableOfContents><ul><li><a href=#download-trigger>Download Trigger</a><ul><li><a href=#download-bar>Download bar</a></li><li><a href=#download-navigation>Download Navigation</a></li></ul></li><li><a href=#server-side-redirects>Server-Side Redirects</a><ul><li><a href=#inflation>Inflation</a></li></ul></li><li><a href=#cross-origin-redirects>Cross-Origin Redirects</a><ul><li><a href=#csp-violations>CSP Violations</a></li></ul></li><li><a href=#case-scenarios>Case Scenarios</a></li><li><a href=#defense>Defense</a></li><li><a href=#real-world-examples>Real-World Examples</a></li><li><a href=#references>References</a></li></ul></nav></aside></main></body></html>