<!doctype html><html lang=en><head><meta name=generator content="Hugo 0.76.5"><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="XS-Leaks Wiki #  Overview #  Cross-Site Leaks (XS-Leaks, XSLeaks) are a class of vulnerabilities derived from browser side-channel techniques 1. These are similar to Cross-Site Request Forgery 2 (CSRF) techniques but instead of allowing other websites to take actions on behalf of a user, they can be used to infer information about them. This is done by exploiting a variety of features built into browsers 3.
The principle of an XS-Leak #  Websites interacting with each other is core to the behavior of the web."><meta name=theme-color content="#FFFFFF"><meta property="og:title" content="Introduction"><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:url" content="https://xsleaks.com/"><title>Introduction | XS-Leaks Wiki</title><link rel=manifest href=/manifest.json><link rel=icon href=/favicon.png type=image/x-icon><link rel=stylesheet href=/book.min.092646ee0a13bc3d434088e3ef209623b91ad8714e3f5b61c7d3d1a096669ae7.css integrity="sha256-CSZG7goTvD1DQIjj7yCWI7ka2HFOP1thx9PRoJZmmuc="><script defer src=/en.search.min.4bc9b01e5294371ac8468489b960d3193464481b75685f03b00cf0294bc7f3d5.js integrity="sha256-S8mwHlKUNxrIRoSJuWDTGTRkSBt1aF8DsAzwKUvH89U="></script><script defer src=/sw.min.74a8bb07f0bee86d6bb9a2750f073f14d93c7e4512f28860370cfd879e9719b4.js integrity="sha256-dKi7B/C+6G1ruaJ1Dwc/FNk8fkUS8ohgNwz9h56XGbQ="></script><link rel=alternate type=application/rss+xml href=https://xsleaks.com/index.xml title="XS-Leaks Wiki"></head><body><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><nav><h2 class=book-brand><a href=/><span>XS-Leaks Wiki</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li class=book-section-flat><span>Attacks</span><ul><li><a href=/docs/attacks/xs-search/>XS-Search</a></li><li><a href=/docs/attacks/error-events/>Error Events</a></li><li><a href=/docs/attacks/frame-counting/>Frame Counting</a></li><li><a href=/docs/attacks/navigations/>Navigations</a></li><li><a href=/docs/attacks/cache-probing/>Cache Probing</a></li><li><a href=/docs/attacks/id-attribute/>ID Attribute</a></li><li><a href=/docs/attacks/postmessage-broadcasts/>postMessage Broadcasts</a></li><li><span>Browser Features</span><ul><li><a href=/docs/attacks/browser-features/corb/>CORB Leaks</a></li><li><a href=/docs/attacks/browser-features/corp/>CORP Leaks</a></li></ul></li><li><span>Timing Attacks</span><ul><li><a href=/docs/attacks/timing-attacks/clocks/>Clocks</a></li><li><a href=/docs/attacks/timing-attacks/network-timing/>Network Timing</a></li><li><a href=/docs/attacks/timing-attacks/execution-timing/>Execution Timing</a></li><li><a href=/docs/attacks/timing-attacks/hybrid-timing/>Hybrid Timing</a></li><li><a href=/docs/attacks/timing-attacks/connection-pool/>Connection Pool</a></li></ul></li><li><a href=/docs/attacks/experiments/ class=collapsed>Experiments</a></li><li><a href=/docs/attacks/historical/ class=collapsed>Historical</a></li></ul></li><li class=book-section-flat><a href=/docs/defenses/>Defense Mechanisms</a><ul><li><span>Application Design</span><ul><li><a href=/docs/defenses/design-protections/cache-protections/>Cache Protections</a></li><li><a href=/docs/defenses/design-protections/subresource-protections/>Subresource Protections</a></li></ul></li><li><span>Browser Default</span><ul><li><a href=/docs/defenses/browser-default/corb/>Cross-Origin Read Blocking</a></li><li><a href=/docs/defenses/browser-default/partitioned-cache/>Partitioned HTTP Cache</a></li></ul></li><li><span>Opt-In</span><ul><li><a href=/docs/defenses/opt-in/coop/>Cross-Origin-Opener-Policy</a></li><li><a href=/docs/defenses/opt-in/corp/>Cross-Origin-Resource-Policy</a></li><li><a href=/docs/defenses/opt-in/fetch-metadata/>Fetch Metadata</a></li><li><a href=/docs/defenses/opt-in/xfo/>Framing Protections</a></li><li><a href=/docs/defenses/opt-in/same-site-cookies/>Same-Site Cookies</a></li></ul></li></ul></li></ul></nav><script>(function(){var menu=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(event){localStorage.setItem("menu.scrollTop",menu.scrollTop);});menu.scrollTop=localStorage.getItem("menu.scrollTop");})();</script></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Introduction</strong>
<label for=toc-control></label></div></header><article class=markdown><h1 id=xs-leaks-wiki>XS-Leaks Wiki
<a class=anchor href=#xs-leaks-wiki>#</a></h1><h2 id=overview>Overview
<a class=anchor href=#overview>#</a></h2><p>Cross-Site Leaks (XS-Leaks, XSLeaks) are a class of vulnerabilities derived from browser side-channel techniques <sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>. These are similar to Cross-Site Request Forgery <sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup> (CSRF) techniques but instead of allowing other websites to take actions on behalf of a user, they can be used to infer information about them. This is done by exploiting a variety of features built into browsers <sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup>.</p><h2 id=the-principle-of-an-xs-leak>The principle of an XS-Leak
<a class=anchor href=#the-principle-of-an-xs-leak>#</a></h2><p>Websites interacting with each other is core to the behavior of the web. Browsers provide a wide variety of interfaces for such interaction between different web applications. These interfaces have different security measures built on top to try to constrain websites behavior (e.g. the <a href=https://developer.mozilla.org/en-US/docs/Web/Security/Same-origin_policy>Same-Origin Policy</a>). XS-Leaks take advantage of small pieces of information that can leak during these interactions in order to infer sensitive information about users such as their data on other websites, operating systems they use or internal networks they are connected to.</p><p>These pieces of information usually have a binary form and are called oracles. These oracles usually answer with <em>YES</em> and <em>NO</em> to cleverly prepared questions. For example, such an oracle could be asked:</p><blockquote><p>Does the word <em>existent</em> exist in the search results?</p></blockquote><p>In a vulnerable application, the above might be equivalent to:</p><blockquote><p>Does the query <em>?query=existent</em> return HTTP200 status code while the query <em>query=non-existent</em> does not?"</p></blockquote><p>The latter oracle could be formed from an <a href=https://xsleaks.com/docs/attacks/error-events/>Error Event</a> XS-Leak and which could be abused by attackers to infer information about the user.</p><p>Browsers provide a wide range of different APIs that, while well-intended, can end up leaking small amounts of cross-origin information.</p><h2 id=example>Example
<a class=anchor href=#example>#</a></h2><p>Websites are generally not allowed to access data on other websites. For example, <em>evil.com</em> is forbidden from explicitly reading a response from <em>bank.com</em>, but <em>evil.com</em> can attempt to load a script from <em>bank.com</em> since that was originally seen as harmless <sup id=fnref:4><a href=#fn:4 class=footnote-ref role=doc-noteref>4</a></sup>. However, <em>evil.com</em> can also determine whether or not the script successfully loaded.</p><blockquote class="book-hint info"><p>Suppose that <em>bank.com</em> has an API endpoint that returns data about a user&rsquo;s receipt for a given query.</p><ol><li>The page <em>evil.com</em> could attempt to load the URL <em>bank.com/my_receipt?q=groceries</em> as a script, since by default, the browser will attach cookies with the request.</li><li>If the user has recently bought groceries, it will load successfully (because of the HTTP200 status code).</li><li>But if they haven&rsquo;t, it will trigger an <a href=https://xsleaks.com/docs/attacks/error-events/>Error Event</a> (because of the HTTP404 status code) that <em>evil.com</em> can listen for.</li><li>By repeating this with different queries, the attacker could infer a significant amount of information about the user&rsquo;s transaction history.</li></ol></blockquote><p>In the above example, two websites on two different origins (<em>evil.com</em> and <em>bank.com</em>) were interacting through an API that browsers allow websites to use. None of this exploited a bug in the browser or a bug in <em>bank.com</em>. But nonetheless, it allowed <em>evil.com</em> to gain some small amount of information about the user on <em>bank.com</em>.  </p><h2 id=root-cause-of-xs-leaks>Root Cause of XS-Leaks
<a class=anchor href=#root-cause-of-xs-leaks>#</a></h2><p>The root cause of most XS-Leaks is inherent to the design of the web. Oftentimes applications are vulnerable to some cross-site information leaks without having done anything wrong. It is challenging to fix the root cause of XS-Leaks at the browser level because in many cases doing so would break existing websites so browsers are implementing various <a href=https://xsleaks.com/defenses/>Defense Mechanisms</a> that offer applications ways of mitigating some of these issues. Many of these mitigations are used via websites opting into a more restrictive security model, usually through certain HTTP headers (e.g. <em><a href=https://xsleaks.com/docs/defenses/opt-in/coop/>Cross-Origin-Opener-Policy</a>: same-origin</em>), which often times must be combined to achieve the desired outcome.</p><p>We can distinguish different sources of XS-Leaks, such as:</p><ol><li>Browser APIs (e.g. <a href=https://xsleaks.com/docs/attacks/frame-counting/>Frame Counting</a> and <a href=https://xsleaks.com/docs/attacks/timing-attacks/>Timing Attacks</a>)</li><li>Browser Implementation Details and Bugs (e.g. <a href=https://xsleaks.com/docs/attacks/timing-attacks/connection-pool/>Connection Pooling</a> and <a href=https://xsleaks.com/docs/attacks/historical/content-type/#typemustmatch>typeMustMatch</a>)</li><li>Hardware Bugs (e.g. Speculative Execution Attacks <sup id=fnref:5><a href=#fn:5 class=footnote-ref role=doc-noteref>5</a></sup>)</li></ol><h2 id=a-little-bit-of-history>A little bit of history
<a class=anchor href=#a-little-bit-of-history>#</a></h2><p>XS-Leaks have always been part of the web platform but have gained attention in recent years <sup id=fnref:6><a href=#fn:6 class=footnote-ref role=doc-noteref>6</a></sup> as new techniques were found to increase their impact. <a href=https://xsleaks.com/docs/attacks/timing-attacks/network-timing/>Timing attacks</a> against the web have been discussed since at least <a href=https://dl.acm.org/doi/10.1145/352600.352606>2000</a>. In 2015 Gelernter and Herzberg published &ldquo;Cross-Site Search Attacks&rdquo; <sup id=fnref:7><a href=#fn:7 class=footnote-ref role=doc-noteref>7</a></sup> which covered their work on exploiting timing attacks to implement high impact XS-Search attacks against Google and Microsoft. From there, more XS-Leak techniques were discovered and tested over time. Recently, browsers have been working on developing a variety of new standards that will make it easier to defend applications against XS-Leaks.</p><h2 id=about-the-wiki>About the wiki
<a class=anchor href=#about-the-wiki>#</a></h2><p>This wiki is meant to both introduce readers to XS-Leaks and serve as a reference guide to experienced researchers exploiting XS-Leaks. While this wiki contains information on many different techniques, new techniques are always emerging. Improvements, whether to add new techniques or expand existing pages, are always appreciated!</p><h2 id=references>References
<a class=anchor href=#references>#</a></h2><section class=footnotes role=doc-endnotes><hr><ol><li id=fn:1 role=doc-endnote><p>Side Channel Vulnerabilities on the Web - Detection and Prevention, <a href=https://owasp.org/www-pdf-archive/Side_Channel_Vulnerabilities.pdf>link</a> <a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2 role=doc-endnote><p>Cross Site Request Forgery (CSRF), <a href=https://owasp.org/www-community/attacks/csrf>link</a> <a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3 role=doc-endnote><p>These features might be maintained to preserve backwards compatibility, though, sometimes new features are added to browsers regardless of the introduction of potential cross-site leaks (e.g. <a href=https://xsleaks.com/docs/attacks/experiments/scroll-to-text-fragment/>Scroll to Text Fragment</a>) as the benefits are considered to outweigh the downsides. <a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:4 role=doc-endnote><p>Websites being able to interact and include resources from each other is a key part of how the web works. For example, many websites allow users to post content that includes images embedded from elsewhere on the web. Fundamentally, this is an intended behavior of the web. But, over time the downsides of this sort of interaction have become better understood. <a href=#fnref:4 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:5 role=doc-endnote><p>Meltdown and Spectre, <a href=https://spectreattack.com/>link</a> <a href=#fnref:5 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:6 role=doc-endnote><p>Browser Side Channels, <a href=https://github.com/xsleaks/xsleaks/wiki/Browser-Side-Channels>link</a> <a href=#fnref:6 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:7 role=doc-endnote><p>Cross-Site Search Attacks, <a href=https://446h.cybersec.fun/xssearch.pdf>link</a> <a href=#fnref:7 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></section></article><footer class=book-footer><div class="flex flex-wrap justify-between"><div><a class="flex align-center" href=https://github.com/xsleaks/wiki/commit/005d73c2fd7ddcd2a6f358dec00144f0360d369a title="Last modified by terjanq | October 18, 2020" target=_blank rel=noopener><img src=/svg/calendar.svg class=book-icon alt=Calendar>
<span>Last Modified: October 18, 2020</span></a></div><div><a class="flex align-center" href=https://github.com/xsleaks/wiki/edit/master/content//_index.md target=_blank rel=noopener><img src=/svg/edit.svg class=book-icon alt=Edit>
<span>Edit this article</span></a></div></div></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div></main></body></html>