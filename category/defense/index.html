<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=theme-color content="#FFFFFF"><meta property="og:title" content="Defense"><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:url" content="https://xsleaks.com/category/defense/"><meta property="og:updated_time" content="2020-10-26T12:58:27-07:00"><title>Defense | XS-Leaks Wiki</title><link rel=manifest href=/manifest.json><link rel=icon href=/favicon.png type=image/x-icon><link rel=stylesheet href=/book.min.092646ee0a13bc3d434088e3ef209623b91ad8714e3f5b61c7d3d1a096669ae7.css integrity="sha256-CSZG7goTvD1DQIjj7yCWI7ka2HFOP1thx9PRoJZmmuc="><script defer src=/en.search.min.f4cf080cf74978f9802e5a76c8965ef1719b508fe4c4201d143a5cd236d734cb.js integrity="sha256-9M8IDPdJePmALlp2yJZe8XGbUI/kxCAdFDpc0jbXNMs="></script><script defer src=/sw.min.74a8bb07f0bee86d6bb9a2750f073f14d93c7e4512f28860370cfd879e9719b4.js integrity="sha256-dKi7B/C+6G1ruaJ1Dwc/FNk8fkUS8ohgNwz9h56XGbQ="></script><link rel=alternate type=application/rss+xml href=https://xsleaks.com/category/defense/index.xml title="XS-Leaks Wiki"></head><body><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><nav><h2 class=book-brand><a href=/><span>XS-Leaks Wiki</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li class=book-section-flat><span>Attacks</span><ul><li><a href=/docs/attacks/xs-search/>XS-Search</a></li><li><a href=/docs/attacks/error-events/>Error Events</a></li><li><a href=/docs/attacks/frame-counting/>Frame Counting</a></li><li><a href=/docs/attacks/navigations/>Navigations</a></li><li><a href=/docs/attacks/cache-probing/>Cache Probing</a></li><li><a href=/docs/attacks/id-attribute/>ID Attribute</a></li><li><a href=/docs/attacks/postmessage-broadcasts/>postMessage Broadcasts</a></li><li><span>Browser Features</span><ul><li><a href=/docs/attacks/browser-features/corb/>CORB Leaks</a></li><li><a href=/docs/attacks/browser-features/corp/>CORP Leaks</a></li></ul></li><li><span>Timing Attacks</span><ul><li><a href=/docs/attacks/timing-attacks/clocks/>Clocks</a></li><li><a href=/docs/attacks/timing-attacks/network-timing/>Network Timing</a></li><li><a href=/docs/attacks/timing-attacks/execution-timing/>Execution Timing</a></li><li><a href=/docs/attacks/timing-attacks/hybrid-timing/>Hybrid Timing</a></li><li><a href=/docs/attacks/timing-attacks/connection-pool/>Connection Pool</a></li></ul></li><li><a href=/docs/attacks/experiments/ class=collapsed>Experiments</a></li><li><a href=/docs/attacks/historical/ class=collapsed>Historical</a></li></ul></li><li class=book-section-flat><a href=/docs/defenses/>Defense Mechanisms</a><ul><li><a href=/docs/defenses/design-protections/>Application Design</a><ul><li><a href=/docs/defenses/design-protections/cache-protections/>Cache Protections</a></li><li><a href=/docs/defenses/design-protections/subresource-protections/>Subresource Protections</a></li></ul></li><li><a href=/docs/defenses/opt-in/>Opt-In Mechanisms</a><ul><li><a href=/docs/defenses/opt-in/coop/>Cross-Origin-Opener-Policy</a></li><li><a href=/docs/defenses/opt-in/corp/>Cross-Origin-Resource-Policy</a></li><li><a href=/docs/defenses/opt-in/fetch-metadata/>Fetch Metadata</a></li><li><a href=/docs/defenses/opt-in/xfo/>Framing Protections</a></li><li><a href=/docs/defenses/opt-in/same-site-cookies/>Same-Site Cookies</a></li></ul></li><li><a href=/docs/defenses/secure-defaults/>Secure Defaults</a><ul><li><a href=/docs/defenses/secure-defaults/corb/>Cross-Origin Read Blocking</a></li><li><a href=/docs/defenses/secure-defaults/partitioned-cache/>Partitioned HTTP Cache</a></li></ul></li></ul></li></ul></nav><script>(function(){var menu=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(event){localStorage.setItem("menu.scrollTop",menu.scrollTop);});menu.scrollTop=localStorage.getItem("menu.scrollTop");})();</script></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Defense</strong>
<label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav><ul><li class=book-section-flat><strong>Abuse</strong><ul><li class="flex justify-between"><a href=/abuse/browser-feature/>Browser Feature</a>
<span>2</span></li><li class="flex justify-between"><a href=/abuse/browser-limits/>Browser Limits</a>
<span>1</span></li><li class="flex justify-between"><a href=/abuse/connection-pool/>Connection Pool</a>
<span>1</span></li><li class="flex justify-between"><a href=/abuse/content-type/>Content-Type</a>
<span>3</span></li><li class="flex justify-between"><a href=/abuse/csp-violations/>CSP Violations</a>
<span>1</span></li><li class="flex justify-between"><a href=/abuse/css-injections/>CSS Injections</a>
<span>1</span></li><li class="flex justify-between"><a href=/abuse/downloads/>Downloads</a>
<span>1</span></li><li class="flex justify-between"><a href=/abuse/error-events/>Error Events</a>
<span>3</span></li><li class="flex justify-between"><a href=/abuse/event-loop/>Event Loop</a>
<span>1</span></li><li class="flex justify-between"><a href=/abuse/focus/>focus</a>
<span>2</span></li><li class="flex justify-between"><a href=/abuse/history/>History</a>
<span>1</span></li><li class="flex justify-between"><a href=/abuse/iframes/>iframes</a>
<span>9</span></li><li class="flex justify-between"><a href=/abuse/nosniff/>nosniff</a>
<span>2</span></li><li class="flex justify-between"><a href=/abuse/onblur/>onblur</a>
<span>2</span></li><li class="flex justify-between"><a href=/abuse/postmessage/>postMessage</a>
<span>1</span></li><li class="flex justify-between"><a href=/abuse/redirects/>Redirects</a>
<span>1</span></li><li class="flex justify-between"><a href=/abuse/regex-injections/>Regex Injections</a>
<span>1</span></li><li class="flex justify-between"><a href=/abuse/service-workers/>Service Workers</a>
<span>1</span></li><li class="flex justify-between"><a href=/abuse/site-isolation/>Site Isolation</a>
<span>1</span></li><li class="flex justify-between"><a href=/abuse/status-code/>Status Code</a>
<span>2</span></li><li class="flex justify-between"><a href=/abuse/typemustmatch/>typeMustMatch</a>
<span>1</span></li><li class="flex justify-between"><a href=/abuse/window.open/>window.open</a>
<span>2</span></li><li class="flex justify-between"><a href=/abuse/cache/>Cache</a>
<span>1</span></li></ul></li><li class=book-section-flat><strong>Category</strong><ul><li class="flex justify-between"><a href=/category/defense/>Defense</a>
<span>9</span></li><li class="flex justify-between"><a href=/category/attack/>Attack</a>
<span>13</span></li><li class="flex justify-between"><a href=/category/attack-principle/>Attack Principle</a>
<span>1</span></li><li class="flex justify-between"><a href=/category/experiments/>Experiments</a>
<span>2</span></li><li class="flex justify-between"><a href=/category/historical/>Historical</a>
<span>2</span></li><li class="flex justify-between"><a href=/category/instrument/>Instrument</a>
<span>1</span></li></ul></li><li class=book-section-flat><strong>Defenses</strong><ul><li class="flex justify-between"><a href=/defenses/application-fix/>Application Fix</a>
<span>1</span></li><li class="flex justify-between"><a href=/defenses/browser-fix/>Browser Fix</a>
<span>1</span></li><li class="flex justify-between"><a href=/defenses/coop/>COOP</a>
<span>5</span></li><li class="flex justify-between"><a href=/defenses/deprecation/>Deprecation</a>
<span>1</span></li><li class="flex justify-between"><a href=/defenses/fetch-metadata/>Fetch Metadata</a>
<span>11</span></li><li class="flex justify-between"><a href=/defenses/framing-protections/>Framing Protections</a>
<span>5</span></li><li class="flex justify-between"><a href=/defenses/samesite-cookies/>SameSite Cookies</a>
<span>12</span></li><li class="flex justify-between"><a href=/defenses/subresource-protections/>Subresource Protections</a>
<span>1</span></li><li class="flex justify-between"><a href=/defenses/vary-sec-fetch-site/>Vary: Sec-Fetch-Site</a>
<span>1</span></li></ul></li></ul></nav></aside></header><article class="markdown book-post"><h2><a href=/docs/defenses/design-protections/cache-protections/>Cache Protections</a></h2><h5>October 16, 2020</h5><div>Category
<a href=/category/defense/>Defense</a></div><p>There are a number of different approaches for defending against cache probing based XS-Leaks.
Cache Protection via Cache-Control Headers # If it is acceptable to disable caching, this provides a strong defense against cache probing attacks. This means that every time someone loads a resource, the resource will have to be fetched again. This can be done by setting a Cache-Control: no-store header on every single response that you wish to protect.
<a href=/docs/defenses/design-protections/cache-protections/>...</a></p></article><article class="markdown book-post"><h2><a href=/docs/defenses/secure-defaults/corb/>Cross-Origin Read Blocking</a></h2><h5>October 1, 2020</h5><div>Category
<a href=/category/defense/>Defense</a></div><p>Cross-Origin Read Blocking (CORB) is a security mechanism that prevents attackers from loading certain cross-origin resources 1. This protection was created to defend against speculative side-channel attacks such as Spectre that allow attackers to read the memory of their own process. CORB aims to prevent attackers from loading certain sensitive cross-origin resources into an attacker controlled process. For example, if the attacker tries to load cross-origin HTML, XML, or JSON into an img tag, CORB will prevent this from happening.
<a href=/docs/defenses/secure-defaults/corb/>...</a></p></article><article class="markdown book-post"><h2><a href=/docs/defenses/opt-in/coop/>Cross-Origin-Opener-Policy</a></h2><h5>October 1, 2020</h5><div>Category
<a href=/category/defense/>Defense</a></div><p>Getting access to a website&rsquo;s window object is a common prerequisite for different XS-Leak techniques. Framing Protections can ensure that an attacker cannot use iframes to access the window object, but this does not stop an attacker from accessing it from an opened window through window.open(url) or window.opener references.
Exploiting XS-Leaks with window.open is generally seen as the least appealing option for an attacker because the user can see it happen in the open browser window.
<a href=/docs/defenses/opt-in/coop/>...</a></p></article><article class="markdown book-post"><h2><a href=/docs/defenses/opt-in/corp/>Cross-Origin-Resource-Policy</a></h2><h5>October 1, 2020</h5><div>Category
<a href=/category/defense/>Defense</a></div><p>Cross-Origin Resource Policy (CORP) is a web platform security feature that allows websites to prevent certain resources from being loaded by other origins. This protection complements CORB since it is an opt-in defense whereas CORB blocks some cross-origin reads by default. It is designed to protect against both speculative execution attacks and XS-Leaks by allowing developers to ensure that sensitive resources cannot end up in attacker controlled processes. Unlike CORB, this protection is enforced in the browser only if an application opts in to the protection.
<a href=/docs/defenses/opt-in/corp/>...</a></p></article><article class="markdown book-post"><h2><a href=/docs/defenses/opt-in/fetch-metadata/>Fetch Metadata</a></h2><h5>October 1, 2020</h5><div>Category
<a href=/category/defense/>Defense</a></div><p>Fetch metadata headers are sent by browsers with every HTTP request. These headers provide context on how a request was initiated so that applications are able to make more informed decisions on how to respond to them. This allows servers to behave differently when they detect potential attacks (e.g. unexpected cross-origin requests)1. This can be very effective against cross-origin attacks like XSSI, XS-Leaks, Clickjacking, and CSRF if a strict policy is deployed on the server.
<a href=/docs/defenses/opt-in/fetch-metadata/>...</a></p></article><article class="markdown book-post"><h2><a href=/docs/defenses/opt-in/xfo/>Framing Protections</a></h2><h5>October 1, 2020</h5><div>Category
<a href=/category/defense/>Defense</a></div><p>A considerable number of XS-Leaks relies on some properties of iframes. If an attacker is unable to embed the contents of a page as an iframe, frame, embed or object then the attack may no longer be possible. To mitigate XS-Leaks which rely on these objects, pages can forbid or select which origins can embed them. This is possible by using the X-Frame-Options Header or the CSP frame-ancestors directive.
Since a website enforcing Framing Protections can&rsquo;t be embedded from an attacker origin, the website is not rendered and the JavaScript does not run.
<a href=/docs/defenses/opt-in/xfo/>...</a></p></article><article class="markdown book-post"><h2><a href=/docs/defenses/secure-defaults/partitioned-cache/>Partitioned HTTP Cache</a></h2><h5>October 1, 2020</h5><div>Category
<a href=/category/defense/>Defense</a></div><p>In order to defend against cache probing attacks, browsers are actively working on implementing a partitioned HTTP cache that would in essence ensure each website has a distinct cache. Since cache probing relies on the fact that browsers' HTTP cache is shared across every website, this can defend against many cache probing techniques. This is done by using tuples (either (top-frame-site, resource-url) or (top-frame-site, framing-site, resource-url)) as the cache keys to ensure the cache is partitioned by the requesting site.
<a href=/docs/defenses/secure-defaults/partitioned-cache/>...</a></p></article><article class="markdown book-post"><h2><a href=/docs/defenses/opt-in/same-site-cookies/>Same-Site Cookies</a></h2><h5>October 1, 2020</h5><div>Category
<a href=/category/defense/>Defense</a></div><p>Same-Site cookies are one of the most impactful modern security mechanisms for fixing security issues that involve cross-site requests. This mechanism allows applications to make browsers only include cookies in requests that are issued same-site 1. This type of cookies has three modes: None, Lax, and Strict.
Same-Site Cookie Modes # None disables all protections and restores the old behavior of cookies. This mode is not recommended.
The None attribute must come with the Secure flag [^same-site-none].
<a href=/docs/defenses/opt-in/same-site-cookies/>...</a></p></article><article class="markdown book-post"><h2><a href=/docs/defenses/design-protections/subresource-protections/>Subresource Protections</a></h2><h5>October 1, 2020</h5><div>Category
<a href=/category/defense/>Defense</a></div><p>The fundamental idea behind designing protections for subresources is that subresources cannot be targeted by XS-Leaks if the attacker cannot cause them to return any user data. If implemented correctly, this can be a very strong defense though it is likely to be tough to implement and could negatively impact the user experience.
It can be very effective to deploy this on any specific resources that are known to be especially senstive to XS-Leaks.
<a href=/docs/defenses/design-protections/subresource-protections/>...</a></p></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div></footer><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><nav><ul><li class=book-section-flat><strong>Abuse</strong><ul><li class="flex justify-between"><a href=/abuse/browser-feature/>Browser Feature</a>
<span>2</span></li><li class="flex justify-between"><a href=/abuse/browser-limits/>Browser Limits</a>
<span>1</span></li><li class="flex justify-between"><a href=/abuse/connection-pool/>Connection Pool</a>
<span>1</span></li><li class="flex justify-between"><a href=/abuse/content-type/>Content-Type</a>
<span>3</span></li><li class="flex justify-between"><a href=/abuse/csp-violations/>CSP Violations</a>
<span>1</span></li><li class="flex justify-between"><a href=/abuse/css-injections/>CSS Injections</a>
<span>1</span></li><li class="flex justify-between"><a href=/abuse/downloads/>Downloads</a>
<span>1</span></li><li class="flex justify-between"><a href=/abuse/error-events/>Error Events</a>
<span>3</span></li><li class="flex justify-between"><a href=/abuse/event-loop/>Event Loop</a>
<span>1</span></li><li class="flex justify-between"><a href=/abuse/focus/>focus</a>
<span>2</span></li><li class="flex justify-between"><a href=/abuse/history/>History</a>
<span>1</span></li><li class="flex justify-between"><a href=/abuse/iframes/>iframes</a>
<span>9</span></li><li class="flex justify-between"><a href=/abuse/nosniff/>nosniff</a>
<span>2</span></li><li class="flex justify-between"><a href=/abuse/onblur/>onblur</a>
<span>2</span></li><li class="flex justify-between"><a href=/abuse/postmessage/>postMessage</a>
<span>1</span></li><li class="flex justify-between"><a href=/abuse/redirects/>Redirects</a>
<span>1</span></li><li class="flex justify-between"><a href=/abuse/regex-injections/>Regex Injections</a>
<span>1</span></li><li class="flex justify-between"><a href=/abuse/service-workers/>Service Workers</a>
<span>1</span></li><li class="flex justify-between"><a href=/abuse/site-isolation/>Site Isolation</a>
<span>1</span></li><li class="flex justify-between"><a href=/abuse/status-code/>Status Code</a>
<span>2</span></li><li class="flex justify-between"><a href=/abuse/typemustmatch/>typeMustMatch</a>
<span>1</span></li><li class="flex justify-between"><a href=/abuse/window.open/>window.open</a>
<span>2</span></li><li class="flex justify-between"><a href=/abuse/cache/>Cache</a>
<span>1</span></li></ul></li><li class=book-section-flat><strong>Category</strong><ul><li class="flex justify-between"><a href=/category/defense/>Defense</a>
<span>9</span></li><li class="flex justify-between"><a href=/category/attack/>Attack</a>
<span>13</span></li><li class="flex justify-between"><a href=/category/attack-principle/>Attack Principle</a>
<span>1</span></li><li class="flex justify-between"><a href=/category/experiments/>Experiments</a>
<span>2</span></li><li class="flex justify-between"><a href=/category/historical/>Historical</a>
<span>2</span></li><li class="flex justify-between"><a href=/category/instrument/>Instrument</a>
<span>1</span></li></ul></li><li class=book-section-flat><strong>Defenses</strong><ul><li class="flex justify-between"><a href=/defenses/application-fix/>Application Fix</a>
<span>1</span></li><li class="flex justify-between"><a href=/defenses/browser-fix/>Browser Fix</a>
<span>1</span></li><li class="flex justify-between"><a href=/defenses/coop/>COOP</a>
<span>5</span></li><li class="flex justify-between"><a href=/defenses/deprecation/>Deprecation</a>
<span>1</span></li><li class="flex justify-between"><a href=/defenses/fetch-metadata/>Fetch Metadata</a>
<span>11</span></li><li class="flex justify-between"><a href=/defenses/framing-protections/>Framing Protections</a>
<span>5</span></li><li class="flex justify-between"><a href=/defenses/samesite-cookies/>SameSite Cookies</a>
<span>12</span></li><li class="flex justify-between"><a href=/defenses/subresource-protections/>Subresource Protections</a>
<span>1</span></li><li class="flex justify-between"><a href=/defenses/vary-sec-fetch-site/>Vary: Sec-Fetch-Site</a>
<span>1</span></li></ul></li></ul></nav></aside></main></body></html>