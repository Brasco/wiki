<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=theme-color content="#FFFFFF"><meta property="og:title" content="defenses"><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:url" content="https://xsleaks.com/category/defenses/"><meta property="og:updated_time" content="2020-09-27T16:08:28+01:00"><title>defenses | XS-Leaks Wiki</title><link rel=manifest href=/manifest.json><link rel=icon href=/favicon.png type=image/x-icon><link rel=stylesheet href=/book.min.3fdda1dce1e2459a1b1fc70c3e00001cd6e4d2f1f32f38ddef6e12ca41e9cef6.css integrity="sha256-P92h3OHiRZobH8cMPgAAHNbk0vHzLzjd724SykHpzvY="><script defer src=/en.search.min.55bbe51b7c566d76276792047f4ea0e56d93dbbc0aefdca33c3791dc096ab941.js integrity="sha256-VbvlG3xWbXYnZ5IEf06g5W2T27wK79yjPDeR3AlquUE="></script><script defer src=/sw.min.74a8bb07f0bee86d6bb9a2750f073f14d93c7e4512f28860370cfd879e9719b4.js integrity="sha256-dKi7B/C+6G1ruaJ1Dwc/FNk8fkUS8ohgNwz9h56XGbQ="></script><link rel=alternate type=application/rss+xml href=https://xsleaks.com/category/defenses/index.xml title="XS-Leaks Wiki"></head><body><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><nav><h2 class=book-brand><a href=/><span>XS-Leaks Wiki</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li class=book-section-flat><a href=/docs/attacks/>Attacks</a><ul><li><a href=/docs/attacks/experiments/>Experiments</a><ul><li><a href=/docs/attacks/experiments/scroll-to-text-fragment/>Scroll to Text Fragment</a></li></ul></li><li><a href=/docs/attacks/historical/ class=collapsed>Historical</a></li><li><a href=/docs/attacks/timing-attacks/>Timing Attacks</a><ul><li><a href=/docs/attacks/timing-attacks/clocks/>Clocks</a></li><li><a href=/docs/attacks/timing-attacks/connection-pool/>Connection Pool</a></li><li><a href=/docs/attacks/timing-attacks/execution-timing/>Execution Timing</a></li><li><a href=/docs/attacks/timing-attacks/hybrid-timing/>Hybrid Timing</a></li><li><a href=/docs/attacks/timing-attacks/network-timing/>Network Timing</a></li></ul></li><li><a href=/docs/attacks/corb/>CORB Leaks</a></li><li><a href=/docs/attacks/corp/>CORP Leaks</a></li><li><a href=/docs/attacks/error-events/>Error Events</a></li><li><a href=/docs/attacks/frame-counting/>Frame Counting</a></li><li><a href=/docs/attacks/id-attribute/>ID Attribute</a></li><li><a href=/docs/attacks/navigations/>Navigations</a></li><li><a href=/docs/attacks/postmessage-broadcasts/>postMessage Broadcasts</a></li><li><a href=/docs/attacks/xs-search/>XS-Search</a></li><li><a href=/docs/attacks/cache-probing/>Cache Probing</a></li></ul></li><li class=book-section-flat><a href=/docs/defenses/>Defense Mechanisms</a><ul><li><span>Application Design</span><ul><li><a href=/docs/defenses/design-protections/subresource-protections/>Subresource Protections</a></li></ul></li><li><span>Browser Default</span><ul><li><a href=/docs/defenses/browser-intrinsic/corb/>Cross-Origin Read Blocking</a></li><li><a href=/docs/defenses/browser-intrinsic/partitioned-cache/>Partitioned HTTP Cache</a></li></ul></li><li><span>Opt-In</span><ul><li><a href=/docs/defenses/opt-in/coop/>Cross-Origin-Opener-Policy</a></li><li><a href=/docs/defenses/opt-in/corp/>Cross-Origin-Resource-Policy</a></li><li><a href=/docs/defenses/opt-in/fetch-metadata/>Fetch Metadata</a></li><li><a href=/docs/defenses/opt-in/xfo/>Framing Protections</a></li><li><a href=/docs/defenses/opt-in/same-site-cookies/>Same-Site Cookies</a></li></ul></li></ul></li></ul></nav><script>(function(){var menu=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(event){localStorage.setItem("menu.scrollTop",menu.scrollTop);});menu.scrollTop=localStorage.getItem("menu.scrollTop");})();</script></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label>
<strong>defenses</strong>
<label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav><ul><li class=book-section-flat><strong>Attacks</strong><ul><li class="flex justify-between"><a href=/attacks/dom-property/>dom property</a>
<span>16</span></li><li class="flex justify-between"><a href=/attacks/ids/>ids</a>
<span>1</span></li><li class="flex justify-between"><a href=/attacks/second-example/>second example</a>
<span>1</span></li></ul></li><li class=book-section-flat><strong>Category</strong><ul><li class="flex justify-between"><a href=/category/attacks/>attacks</a>
<span>15</span></li><li class="flex justify-between"><a href=/category/defenses/>defenses</a>
<span>9</span></li><li class="flex justify-between"><a href=/category/historical/>historical</a>
<span>2</span></li></ul></li><li class=book-section-flat><strong>Defenses</strong><ul><li class="flex justify-between"><a href=/defenses/coop/>COOP</a>
<span>1</span></li><li class="flex justify-between"><a href=/defenses/deprecation/>deprecation</a>
<span>1</span></li><li class="flex justify-between"><a href=/defenses/same-site-cookies/>same-site cookies</a>
<span>13</span></li><li class="flex justify-between"><a href=/defenses/sec-fetch-metadata/>sec-fetch metadata</a>
<span>12</span></li><li class="flex justify-between"><a href=/defenses/todo/>TODO</a>
<span>1</span></li><li class="flex justify-between"><a href=/defenses/xfo/>XFO</a>
<span>1</span></li></ul></li></ul></nav></aside></header><article class="markdown book-post"><h2><a href=/docs/defenses/browser-intrinsic/corb/>Cross-Origin Read Blocking</a></h2><h5>July 21, 2020</h5><div>Category
<a href=/category/defenses/>defenses</a></div><p>Explanation # Cross-Origin Read Blocking (CORB) is a browser defense mechanism that prevents attackers from loading certain cross-origin resources in unlikely scenarios 1. This protection was created to prevent speculative side-channel attacks such as Spectre which allow attackers to read the memory of their own process. CORB aims to prevent attackers from loading cross-origin contents which might contain sensitive information into an attacker-controlled process. For instance, if an attacker tries to load an HTML, XML, or JSON as an img or script tag, CORB will prevent this from happening.
<a href=/docs/defenses/browser-intrinsic/corb/>...</a></p></article><article class="markdown book-post"><h2><a href=/docs/defenses/opt-in/coop/>Cross-Origin-Opener-Policy</a></h2><h5>July 21, 2020</h5><div>Category
<a href=/category/defenses/>defenses</a></div><p>Explanation # A good portion of XS-Leaks has multiple alternatives to execute the same attack, some in common with each other. For instance, some XS-Leaks abuse properties of iframes to succeed which can be fully mitigated by deploying Framing Protections. However, this same group of XS-Leaks can usually be abused by other common alternatives, that need other protections. One of those alternatives consists of navigating the user away using window.
<a href=/docs/defenses/opt-in/coop/>...</a></p></article><article class="markdown book-post"><h2><a href=/docs/defenses/opt-in/corp/>Cross-Origin-Resource-Policy</a></h2><h5>July 21, 2020</h5><div>Category
<a href=/category/defenses/>defenses</a></div><p>Cross-Origin-Resource-Policy (CORP) response header enforces Cross-Origin Read Blocking (CORB) as it provides more protection by covering more resources 1. Both protect against speculative side-channel attacks (Spectre) by preventing attackers from loading certain cross-origin resources in elements like script, img, video, etc. Unlike CORB, this protection is enforced in the browser only if an application opts into the protection. Applications can define which groups of origins (same-site, same-origin, cross-site) are allowed to read their resources.
<a href=/docs/defenses/opt-in/corp/>...</a></p></article><article class="markdown book-post"><h2><a href=/docs/defenses/design-protections/defensive-design/>Defensive Design</a></h2><h5>July 21, 2020</h5><div>Category
<a href=/category/defenses/>defenses</a></div><p>This section should focus on defensive design techniques to prevent XS-Leaks from happening. Some ideas:
The way applications use iframes to display information based on a user query (search system) How applications use Fetch Metadata with Vary headers to prevent cache probing attacks and what problems might occur with improper deployments. Are there any drawbacks of deploying this? How to ensure all application endpoints implement certain Headers to have the same behavior across different states.
<a href=/docs/defenses/design-protections/defensive-design/>...</a></p></article><article class="markdown book-post"><h2><a href=/docs/defenses/opt-in/fetch-metadata/>Fetch Metadata</a></h2><h5>July 21, 2020</h5><div>Category
<a href=/category/defenses/>defenses</a></div><p>Fetch Metadata Headers are sent by browsers in every request or navigation made by a page. These Headers provide context on how every request/navigation was initiated so that applications are able to make more informed decisions on how to respond to them. This allows servers to behave differently when they detect potential attacks (i.e. unexpected cross-origin requests)1. This mechanism can be very effective against cross-origin attacks like XSSI, XS-Leaks, Clickjacking, and CSRF.
<a href=/docs/defenses/opt-in/fetch-metadata/>...</a></p></article><article class="markdown book-post"><h2><a href=/docs/defenses/opt-in/xfo/>Framing Protections</a></h2><h5>July 21, 2020</h5><div>Category
<a href=/category/defenses/>defenses</a></div><p>Explanation # A considerable number of XS-Leaks relies on some properties of iframes. If an attacker is unable to embed the contents of a page as an iframe then the attack may no longer be possible. To mitigate XS-Leaks which rely on this object, pages can forbid or select which origins can embed them. This is possible by using the X-Frame-Options Header or the CSP frame-ancestors directive.
Since a website enforcing Framing Protections can&rsquo;t be embedded from an attacker origin, the website is not rendered and the JavaScript does not run.
<a href=/docs/defenses/opt-in/xfo/>...</a></p></article><article class="markdown book-post"><h2><a href=/docs/defenses/browser-intrinsic/partitioned-cache/>Partitioned HTTP Cache</a></h2><h5>July 21, 2020</h5><div>Category
<a href=/category/defenses/>defenses</a></div><p>Explanation # Cache probing attacks have been present on the web for a long time mainly because browsers HTTP cache is shared across all the websites visited by a user, allowing attackers to interact with it and infer private information from other origins.
Considering Opt-in solutions, applications can use the Vary Header combined with Fetch-Metadata to prevent cross-origin fetches to be affected by the site cache or use some workarounds to protect resources, which come with downsides.
<a href=/docs/defenses/browser-intrinsic/partitioned-cache/>...</a></p></article><article class="markdown book-post"><h2><a href=/docs/defenses/opt-in/same-site-cookies/>Same-Site Cookies</a></h2><h5>July 21, 2020</h5><div>Category
<a href=/category/defenses/>defenses</a></div><p>Explanation # Same-Site Cookies are one of the most impactful Security Mechanisms towards fixing security issues that involve cross-site requests. This mechanism allows applications to add a special restriction to cookies, forcing browsers to only append them in requests that are issued same-site 1. This type of cookies has two modes: Lax and Strict.
Lax V.s Strict # The only difference between Lax and Strict is that Lax mode allows cookies to be added to requests triggered by top-level navigations.
<a href=/docs/defenses/opt-in/same-site-cookies/>...</a></p></article><article class="markdown book-post"><h2><a href=/docs/defenses/design-protections/subresource-protections/>Subresource Protections</a></h2><h5>July 21, 2020</h5><div>Category
<a href=/category/defenses/>defenses</a></div><p>Random tokens # One of the principles of protecting subresources is the same as protecting endpoints from CSRF attacks. The difference from CSRF protections is that in the case of XS-Leaks, GET requests are the ones usually worth protecting. To apply this protection applications can append a (cryptographically strong) pseudorandom value, unique to each request/session, to make the URL of a subresource unpredictable to an attacker. The protection can be applied to the following types of subresources:
<a href=/docs/defenses/design-protections/subresource-protections/>...</a></p></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div></footer><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><nav><ul><li class=book-section-flat><strong>Attacks</strong><ul><li class="flex justify-between"><a href=/attacks/dom-property/>dom property</a>
<span>16</span></li><li class="flex justify-between"><a href=/attacks/ids/>ids</a>
<span>1</span></li><li class="flex justify-between"><a href=/attacks/second-example/>second example</a>
<span>1</span></li></ul></li><li class=book-section-flat><strong>Category</strong><ul><li class="flex justify-between"><a href=/category/attacks/>attacks</a>
<span>15</span></li><li class="flex justify-between"><a href=/category/defenses/>defenses</a>
<span>9</span></li><li class="flex justify-between"><a href=/category/historical/>historical</a>
<span>2</span></li></ul></li><li class=book-section-flat><strong>Defenses</strong><ul><li class="flex justify-between"><a href=/defenses/coop/>COOP</a>
<span>1</span></li><li class="flex justify-between"><a href=/defenses/deprecation/>deprecation</a>
<span>1</span></li><li class="flex justify-between"><a href=/defenses/same-site-cookies/>same-site cookies</a>
<span>13</span></li><li class="flex justify-between"><a href=/defenses/sec-fetch-metadata/>sec-fetch metadata</a>
<span>12</span></li><li class="flex justify-between"><a href=/defenses/todo/>TODO</a>
<span>1</span></li><li class="flex justify-between"><a href=/defenses/xfo/>XFO</a>
<span>1</span></li></ul></li></ul></nav></aside></main></body></html>