<!doctype html><html lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content><meta name=theme-color content="#FFFFFF"><meta property="og:title" content="dom property"><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:url" content="https://xsleaks.com/attacks/dom-property/"><meta property="og:updated_time" content="2020-09-29T17:58:43+02:00"><title>dom property | XS-Leaks Wiki</title><link rel=manifest href=/manifest.json><link rel=icon href=/favicon.png type=image/x-icon><link rel=stylesheet href=/book.min.3fdda1dce1e2459a1b1fc70c3e00001cd6e4d2f1f32f38ddef6e12ca41e9cef6.css integrity="sha256-P92h3OHiRZobH8cMPgAAHNbk0vHzLzjd724SykHpzvY="><script defer src=/en.search.min.55bbe51b7c566d76276792047f4ea0e56d93dbbc0aefdca33c3791dc096ab941.js integrity="sha256-VbvlG3xWbXYnZ5IEf06g5W2T27wK79yjPDeR3AlquUE="></script><script defer src=/sw.min.74a8bb07f0bee86d6bb9a2750f073f14d93c7e4512f28860370cfd879e9719b4.js integrity="sha256-dKi7B/C+6G1ruaJ1Dwc/FNk8fkUS8ohgNwz9h56XGbQ="></script><link rel=alternate type=application/rss+xml href=https://xsleaks.com/attacks/dom-property/index.xml title="XS-Leaks Wiki"></head><body><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><nav><h2 class=book-brand><a href=/><span>XS-Leaks Wiki</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li class=book-section-flat><a href=/docs/attacks/>Attacks</a><ul><li><a href=/docs/attacks/experiments/>Experiments</a><ul><li><a href=/docs/attacks/experiments/scroll-to-text-fragment/>Scroll to Text Fragment</a></li></ul></li><li><a href=/docs/attacks/historical/ class=collapsed>Historical</a></li><li><a href=/docs/attacks/timing-attacks/>Timing Attacks</a><ul><li><a href=/docs/attacks/timing-attacks/clocks/>Clocks</a></li><li><a href=/docs/attacks/timing-attacks/connection-pool/>Connection Pool</a></li><li><a href=/docs/attacks/timing-attacks/execution-timing/>Execution Timing</a></li><li><a href=/docs/attacks/timing-attacks/hybrid-timing/>Hybrid Timing</a></li><li><a href=/docs/attacks/timing-attacks/network-timing/>Network Timing</a></li></ul></li><li><a href=/docs/attacks/corb/>CORB Leaks</a></li><li><a href=/docs/attacks/corp/>CORP Leaks</a></li><li><a href=/docs/attacks/error-events/>Error Events</a></li><li><a href=/docs/attacks/frame-counting/>Frame Counting</a></li><li><a href=/docs/attacks/id-attribute/>ID Attribute</a></li><li><a href=/docs/attacks/navigations/>Navigations</a></li><li><a href=/docs/attacks/postmessage-broadcasts/>postMessage Broadcasts</a></li><li><a href=/docs/attacks/xs-search/>XS-Search</a></li><li><a href=/docs/attacks/cache-probing/>Cache Probing</a></li></ul></li><li class=book-section-flat><a href=/docs/defenses/>Defense Mechanisms</a><ul><li><span>Application Design</span><ul><li><a href=/docs/defenses/design-protections/subresource-protections/>Subresource Protections</a></li></ul></li><li><span>Browser Default</span><ul><li><a href=/docs/defenses/browser-intrinsic/corb/>Cross-Origin Read Blocking</a></li><li><a href=/docs/defenses/browser-intrinsic/partitioned-cache/>Partitioned HTTP Cache</a></li></ul></li><li><span>Opt-In</span><ul><li><a href=/docs/defenses/opt-in/coop/>Cross-Origin-Opener-Policy</a></li><li><a href=/docs/defenses/opt-in/corp/>Cross-Origin-Resource-Policy</a></li><li><a href=/docs/defenses/opt-in/fetch-metadata/>Fetch Metadata</a></li><li><a href=/docs/defenses/opt-in/xfo/>Framing Protections</a></li><li><a href=/docs/defenses/opt-in/same-site-cookies/>Same-Site Cookies</a></li></ul></li></ul></li></ul></nav><script>(function(){var menu=document.querySelector("aside.book-menu nav");addEventListener("beforeunload",function(event){localStorage.setItem("menu.scrollTop",menu.scrollTop);});menu.scrollTop=localStorage.getItem("menu.scrollTop");})();</script></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/svg/menu.svg class=book-icon alt=Menu></label>
<strong>dom property</strong>
<label for=toc-control><img src=/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav><ul><li class=book-section-flat><strong>Attacks</strong><ul><li class="flex justify-between"><a href=/attacks/dom-property/>dom property</a>
<span>16</span></li><li class="flex justify-between"><a href=/attacks/ids/>ids</a>
<span>1</span></li><li class="flex justify-between"><a href=/attacks/second-example/>second example</a>
<span>1</span></li></ul></li><li class=book-section-flat><strong>Category</strong><ul><li class="flex justify-between"><a href=/category/attacks/>attacks</a>
<span>15</span></li><li class="flex justify-between"><a href=/category/defenses/>defenses</a>
<span>9</span></li><li class="flex justify-between"><a href=/category/historical/>historical</a>
<span>2</span></li></ul></li><li class=book-section-flat><strong>Defenses</strong><ul><li class="flex justify-between"><a href=/defenses/coop/>COOP</a>
<span>1</span></li><li class="flex justify-between"><a href=/defenses/deprecation/>deprecation</a>
<span>1</span></li><li class="flex justify-between"><a href=/defenses/same-site-cookies/>same-site cookies</a>
<span>13</span></li><li class="flex justify-between"><a href=/defenses/sec-fetch-metadata/>sec-fetch metadata</a>
<span>12</span></li><li class="flex justify-between"><a href=/defenses/todo/>TODO</a>
<span>1</span></li><li class="flex justify-between"><a href=/defenses/xfo/>XFO</a>
<span>1</span></li></ul></li></ul></nav></aside></header><article class="markdown book-post"><h2><a href=/docs/attacks/postmessage-broadcasts/>postMessage Broadcasts</a></h2><h5>July 21, 2020</h5><div>Attacks
<a href=/attacks/dom-property/>dom property</a></div><div>Category
<a href=/category/attacks/>attacks</a></div><p>Applications often use postMessage broadcasts to provide information to any interested origin. Apart from the obvious security issues (providing sensitive information to any origin) other problems might occur if a legitimate postMessage broadcast is not properly deployed 1.
If a broadcast happens based on user information, attackers might be able to leak that information if they can distinguish requests. There are multiple ways applications can be inconsistent with broadcasts based on user information:
<a href=/docs/attacks/postmessage-broadcasts/>...</a></p></article><article class="markdown book-post"><h2><a href=/docs/attacks/experiments/scroll-to-text-fragment/>Scroll to Text Fragment</a></h2><h5>July 21, 2020</h5><div>Attacks
<a href=/attacks/dom-property/>dom property</a></div><div>Category
<a href=/category/attacks/>attacks</a></div><div>Defenses
<a href=/defenses/same-site-cookies/>same-site cookies</a>,
<a href=/defenses/sec-fetch-metadata/>sec-fetch metadata</a></div><p>Scroll to Text Fragment (STTF) is a new web platform feature that allows users to create a link to any part of a web page text. The fragment #:~:text= carries a text snippet that is highlighted and brought into the viewport by the browser. This feature can introduce a new XS-Leak if attackers are able to detect when this behavior occurs. This issue is very similar to the Scroll to CSS Selector XS-Leak.
<a href=/docs/attacks/experiments/scroll-to-text-fragment/>...</a></p></article><article class="markdown book-post"><h2><a href=/docs/attacks/historical/content-type/>typeMustMatch</a></h2><h5>July 21, 2020</h5><div>Attacks
<a href=/attacks/dom-property/>dom property</a></div><div>Category
<a href=/category/historical/>historical</a></div><div>Defenses
<a href=/defenses/deprecation/>deprecation</a></div><p>typeMustMatch is a boolean that reflects the typeMustMatch attribute of the object element. It ensures a certain MIME type must be enforced when loading an object verifying if the Content-Type of the resource is the same as the one provided in the object. Unfortunately, this enforcement would allow attackers to leak the Content-Type and Status Codes returned by a website 1
Root Cause # Considering the snippet below, not_loaded would be rendered if the returned Content-Type of https://target/api did not match the one in type, or the server returned a status different than 200.
<a href=/docs/attacks/historical/content-type/>...</a></p></article><article class="markdown book-post"><h2><a href=/docs/attacks/historical/itp/>WebKit - ITP</a></h2><h5>July 21, 2020</h5><div>Attacks
<a href=/attacks/dom-property/>dom property</a></div><div>Category
<a href=/category/historical/>historical</a></div><div>Defenses
<a href=/defenses/todo/>TODO</a></div><p>Intelligent Tracking Prevention (ITP) is a privacy feature part of WebKit Tracking Prevention technologies. Itâ€™s a conjunction of several features to prevent a website from tracking a user under a third-party context. Unfortunately, the initial design introduced a new XS-Leak 1, allowing attackers to abuse the states implicitly created by ITP to classify websites as trackers.
Root Cause # To classify whether a website had tracking capabilities, ITP collects statistics on resource loads as well as user interactions in websites such as clicks, taps, or text entries.
<a href=/docs/attacks/historical/itp/>...</a></p></article><article class="markdown book-post"><h2><a href=/docs/attacks/xs-search/>XS-Search</a></h2><h5>July 21, 2020</h5><div>Attacks
<a href=/attacks/dom-property/>dom property</a></div><div>Category
<a href=/category/attacks/>attacks</a></div><div>Defenses
<a href=/defenses/same-site-cookies/>same-site cookies</a>,
<a href=/defenses/sec-fetch-metadata/>sec-fetch metadata</a></div><p>Cross-Site Search (XS-Search) is an important attack and principle in the family of XS-Leaks. The attack abuses Query-Based Search Systems to leak user information from an attacker origin. The original attack used timing measurements to detect when a search system returned results or no results and works as follows:
Establish a baseline time for a request returning results (hit), and a baseline for a request with no results (miss). Start a timing attack on the request to the search endpoint, brute-forcing the first character (?
<a href=/docs/attacks/xs-search/>...</a></p></article><article class="markdown book-post"><h2><a href=/docs/attacks/cache-probing/>Cache Probing</a></h2><div>Attacks
<a href=/attacks/dom-property/>dom property</a></div><div>Category
<a href=/category/attacks/>attacks</a></div><div>Defenses
<a href=/defenses/same-site-cookies/>same-site cookies</a>,
<a href=/defenses/sec-fetch-metadata/>sec-fetch metadata</a></div><p>The principle of Cache Probing consists of detecting whether some resource was cached by the browser. The concept is known since the begging of the web 1 and initially used timing differences to succeed.
When a user visits a website some resources such as images, scripts and HTML content are fetched and later cached by the browser (under certain conditions). This optimization will make future navigations faster as the browser will serve those resources from disk instead of requesting them again.
<a href=/docs/attacks/cache-probing/>...</a></p></article><ul class=pagination><li class=page-item><a href=/attacks/dom-property/ class=page-link aria-label=First><span aria-hidden=true>&#171;&#171;</span></a></li><li class=page-item><a href=/attacks/dom-property/ class=page-link aria-label=Previous><span aria-hidden=true>&#171;</span></a></li><li class=page-item><a class=page-link href=/attacks/dom-property/>1</a></li><li class="page-item active"><a class=page-link href=/attacks/dom-property/page/2/>2</a></li><li class="page-item disabled"><a class=page-link aria-label=Next><span aria-hidden=true>&#187;</span></a></li><li class=page-item><a href=/attacks/dom-property/page/2/ class=page-link aria-label=Last><span aria-hidden=true>&#187;&#187;</span></a></li></ul><footer class=book-footer><div class="flex flex-wrap justify-between"></div></footer><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><nav><ul><li class=book-section-flat><strong>Attacks</strong><ul><li class="flex justify-between"><a href=/attacks/dom-property/>dom property</a>
<span>16</span></li><li class="flex justify-between"><a href=/attacks/ids/>ids</a>
<span>1</span></li><li class="flex justify-between"><a href=/attacks/second-example/>second example</a>
<span>1</span></li></ul></li><li class=book-section-flat><strong>Category</strong><ul><li class="flex justify-between"><a href=/category/attacks/>attacks</a>
<span>15</span></li><li class="flex justify-between"><a href=/category/defenses/>defenses</a>
<span>9</span></li><li class="flex justify-between"><a href=/category/historical/>historical</a>
<span>2</span></li></ul></li><li class=book-section-flat><strong>Defenses</strong><ul><li class="flex justify-between"><a href=/defenses/coop/>COOP</a>
<span>1</span></li><li class="flex justify-between"><a href=/defenses/deprecation/>deprecation</a>
<span>1</span></li><li class="flex justify-between"><a href=/defenses/same-site-cookies/>same-site cookies</a>
<span>13</span></li><li class="flex justify-between"><a href=/defenses/sec-fetch-metadata/>sec-fetch metadata</a>
<span>12</span></li><li class="flex justify-between"><a href=/defenses/todo/>TODO</a>
<span>1</span></li><li class="flex justify-between"><a href=/defenses/xfo/>XFO</a>
<span>1</span></li></ul></li></ul></nav></aside></main></body></html>